<!-- <html>

<body>
  <ul id="filelist"></ul>
  <script>
    window.requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem;
    function errorHandler(e) {
      console.log(e);
      var msg = '';

      switch (e.code) {
        case FileError.QUOTA_EXCEEDED_ERR:
          msg = 'QUOTA_EXCEEDED_ERR';
          break;
        case FileError.NOT_FOUND_ERR:
          msg = 'NOT_FOUND_ERR';
          break;
        case FileError.SECURITY_ERR:
          msg = 'SECURITY_ERR';
          break;
        case FileError.INVALID_MODIFICATION_ERR:
          msg = 'INVALID_MODIFICATION_ERR';
          break;
        case FileError.INVALID_STATE_ERR:
          msg = 'INVALID_STATE_ERR';
          break;
        default:
          msg = 'Unknown Error';
          break;
      };

      console.log('Error: ' + msg);
    }

    function toArray(list) {
      return Array.prototype.slice.call(list || [], 0);
    }

    function listResults(entries) {
      // Document fragments can improve performance since they're only appended
      // to the DOM once. Only one browser reflow occurs.
      var fragment = document.createDocumentFragment();

      entries.forEach(function (entry, i) {
        var img = entry.isDirectory ? '<img src="folder-icon.gif">' :
          '<img src="file-icon.gif">';
        var li = document.createElement('li');
        li.innerHTML = [img, '<span>', entry.name, '</span>'].join('');
        fragment.appendChild(li);
      });

      document.querySelector('#filelist').appendChild(fragment);
    }

    function onInitFs(fs) {
      fs.root.getDirectory('.', {}, function (dirEntry) {
        var dirReader = dirEntry.createReader();
        dirReader.readEntries(function (entries) {
          for (var i = 0; i < entries.length; i++) {
            var entry = entries[i];
            if (entry.isDirectory) {
              console.log('Directory: ' + entry.fullPath);
            } else if (entry.isFile) {
              console.log('File: ' + entry.fullPath);
            }
          }

        }, errorHandler);
      }, errorHandler);

      // var dirReader = fs.root.createReader();
      // var entries = [];

      // // Call the reader.readEntries() until no more results are returned.
      // var readEntries = function () {
      //   dirReader.readEntries(function (results) {
      //     if (!results.length) {
      //       listResults(entries.sort());
      //     } else {
      //       entries = entries.concat(toArray(results));
      //       readEntries();
      //     }
      //   }, errorHandler);
      // };

      // readEntries(); // Start reading dirs.
    }

    window.requestFileSystem(window.PERSISTENT, 1024 * 1024, onInitFs, errorHandler);
  </script>
</body>

</html> -->